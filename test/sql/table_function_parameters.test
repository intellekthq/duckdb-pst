# name: test/sql/table_function_parameters.test
# description: 
# group: [pst]

require pst

statement ok
PRAGMA enable_verification

statement ok
load pst;

# Test read_limit
query I
SELECT count(*) FROM (SELECT * from read_pst_messages('test/unittest.pst', read_limit = 2));
----
2

# Test read_body_size_bytes (they are wchar_t, so 50 is ok)
query II
SELECT node_id, length(body_html) from read_pst_messages('test/unittest.pst', read_body_size_bytes = 100) where body_html is not null order by node_id asc;
----
2097188	50
2097220	50
2097252	50
2097284	50
2097316	50
2097540	50

# Test read_attachment_body (false by default)
# no results, bs is NULL
query II
SELECT list_first(attachments) as a, a['bytes'] as bs from read_pst_messages('test/unittest.pst') where a['filename'] = 'MEDIUM~2.JPG' and bs is not null;
----

# Test read_attachment_body = true
# no results, bs is not NULL
query II
SELECT list_first(attachments) as a, a['bytes'] as bs from read_pst_messages('test/unittest.pst', read_attachment_body = true) where a['filename'] = 'MEDIUM~2.JPG' and bs is null;
----
